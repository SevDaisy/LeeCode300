package Order300;

public class T41_first_missing_positive {

  public static void main(String[] args) {
    System.out.println(new Solution().firstMissingPositive(new int[] { 1, 1 })); // -> 2
    System.out.println(
      new Solution().firstMissingPositive(new int[] { 1, 2, 0 })
    ); // -> 3
    System.out.println(
      new Solution().firstMissingPositive(new int[] { 3, 4, -1, 1 })
    ); // -> 2
    System.out.println(
      new Solution().firstMissingPositive(new int[] { 7, 8, 9, 11, 12 })
    ); // -> 1
    System.out.println(new Solution().firstMissingPositive(new int[] { 1 })); // -> 2
  }

  /* ç¬¬ä¸€æ¬¡å°è¯• å€Ÿé‰´è‡ªå·±ä»¥å‰çš„ä»£ç ï¼Œåªèƒ½è·‘åˆ° æ—¶é—´ 2ms => 54.47% ç©ºé—´ 94.9MB => 7.00% */
  static class Solution {

    /**
     * æˆ‘ä¸€å¹´å‰å†™è¿‡çš„é¢˜ã€‚ç¬‘æ­»ã€‚æ ¹æœ¬ä¸è®°å¾—è§£æ³•ã€‚æœ€åçœ‹äº†è‡ªå·±çš„å†å²æäº¤ã€‚å€Ÿé‰´æ€æƒ³ï¼Œå°è¯•å¤ç°ä»£ç ã€‚
     * åˆ†æï¼š
     * é¢˜ç›®ï¼Œéš¾å°±éš¾åœ¨æ—¶é—´å¤æ‚åº¦è¦æ±‚ä¸ºO(n)ï¼Œä¸”ç©ºé—´å¤æ‚åº¦ä¸ºO(1)
     *
     * å¦‚æœæ²¡æœ‰æ—¶ç©ºè¦æ±‚ã€‚æ€ä¹ˆåšï¼Ÿ
     * ç›´æ¥è¿‡æ»¤å¹¶æ’åºä¸ºä¸€ä¸ªåªæœ‰æ­£æ•´æ•°çš„æ•°ç»„ï¼Œå†éå†æ•°ç»„ï¼Œæ‰¾åˆ°é‚£ä¸ªä¸ç¬¦åˆ nums[i] = i+1 ï¼Œè¿”å› i+1 å°±å¥½äº†
     *
     * æ‰€ä»¥ï¼Œéš¾ç‚¹å…¶å®æ˜¯ï¼Œè¿‡æ»¤å’Œæ’åºè¦åœ¨ O(n) å†…å®Œæˆ
     *
     * è¿‡æ»¤æ˜¾ç„¶æ²¡é—®é¢˜ã€‚for x in array: x>0 Only å°±å¥½äº†
     * æ’åºï¼Œè¦ O(n) ä¼¼ä¹æ˜¯ä¸€ä¸ªä¸å¯èƒ½çš„ä»»åŠ¡
     *
     * è½¬æ¢æ€è·¯ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„æ’åºé—®é¢˜ã€‚ä¸ºä»€ä¹ˆï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯çŸ¥é“æ¯ä¸ªæ•°å­—æœ€ååº”è¯¥è¢«æ”¾åœ¨å“ªä¸ªä½ç½®ä¸Šçš„ã€‚
     * æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ¯ä¸ªæ•°éƒ½æ¯”æ¥æ¯”å»ã€‚åªè¦æ‹¿åˆ°ä¸€ä¸ªæ•°ï¼Œç„¶åæŠŠä»–æ”¾åˆ°ä»–åº”è¯¥åœ¨çš„ä½ç½®ã€‚
     * å¦‚æœä»–å°±åœ¨é‚£ä¸ªä½ç½®ä¸Šï¼Œé‚£ä¹ˆï¼Œi++ï¼Œç›´æ¥å»çœ‹ä¸‹ä¸€ä¸ªä½ç½®ã€‚ç›´åˆ°æ•´ä¸ªæ•°ç»„éå†å®Œä¸€éã€‚
     * å¦‚æœä»–ä¸åœ¨è‡ªå·±çš„ä½ç½®ä¸Šï¼Œé‚£ä¹ˆï¼Œä¿å­˜åŸæœ¬å äº†ä»–ä½ç½®çš„æ•°ï¼ŒæŠŠè¿™ä¸ªæ•°æ”¾åˆ°å®ƒè¯¥å»çš„åœ°æ–¹ã€‚é‡å¤ï¼Œç›´åˆ°æŠŠæ•´ä¸ªæ•°ç»„éå†å®Œä¸€éã€‚
     *
     * æ¦‚è¦è®¾è®¡å¦‚ä¸Šï¼Œè¿˜è¦æ³¨æ„çš„ç»†èŠ‚é—®é¢˜å¦‚ä¸‹ï¼š
     *
     * æœ€åå¾—åˆ°çš„æ•°ç»„ï¼ŒåŒ…å«å“ªäº›å…ƒç´ ï¼Ÿ
     * å¦‚æœæ•°ç»„ä¸­æ²¡æœ‰ç¼ºå°‘æ­£æ•´æ•°ï¼ŒæŒ‰é¢˜æ„ï¼Œè¿™ä¸ªæ•°ç»„åº”è¯¥æ˜¯è¿™æ ·çš„ [1,2,3,...,iMax]
     * ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œåˆæ³•çš„èŒƒå›´ä¸æ˜¯ x > 0 è€Œæ˜¯ x in [1,iMax]
     *
     * å…³äºæ•°å­—çš„æ¯”è¾ƒå’Œäº¤æ¢ã€‚
     * åº”è¯¥æ˜¯, if nums[nums[i]-1] != nums[i] åˆ™ äº¤æ¢. 
     * è€Œä¸æ˜¯, if nums[i] != i+1 åˆ™ buffer = nums[nums[i]-1]; nums[nums[i]-1] = nums[i];
     * ä¹Ÿå°±è¯´, ä¸èƒ½æ‹¿ç€è¿™ä¸ªæ•°ï¼Œå»ä¿å­˜åˆ°å¦å¤–çš„ bufferã€‚è¿™æ ·çš„ä»£ç è¿œä¸å¦‚ç›´æ¥äº¤æ¢æ¥å¾—ç®€æ˜å¥å£®å¥½ç”¨å¥½çœ‹ã€‚
     * å…·ä½“é€»è¾‘æˆ‘ä¹Ÿè¯´ä¸æ¸…æ¥šã€‚æˆ‘åªçŸ¥é“ï¼Œä¸€å¼€å§‹æƒ³ç”¨ buffer å†™æ¥ç€ï¼Œæˆ‘æ²¡å†™å‡ºæ¥ã€‚
     * å“ï¼Œç»†å“ã€‚æ‚Ÿï¼Œå¥½å¥½æ‚Ÿã€‚æƒ³æ˜ç™½äº†å¯ä»¥æ•™æ•™æˆ‘ğŸ¤ª
     *
     * 
     * è¡¥å……è¯´æ˜ ä¸‹é¢è¿™ä¸ªç®€åŒ–æ˜¯ä¸æˆç«‹çš„ï¼š"nums[nums[i]-1] != nums[i] è½¬åŒ–ä¸º nums[i]-1 != i è½¬åŒ–ä¸º nums[i] != i+1"
     * å› ä¸ºï¼Œ(nums[nums[i]-1] != nums[i]) æ˜¯ (nums[i]-1 != i) çš„ å……åˆ†ä½†ä¸å¿…è¦æ¡ä»¶
     */
    public int firstMissingPositive(int[] nums) {
      // if (nums == null || nums.length == 0) return 0;
      int iMax = nums.length;
      for (int i = 0; i < iMax; i++) {
        while (nums[i] > 0 && nums[i] <= iMax && nums[nums[i] - 1] != nums[i]) {
          int temp = nums[nums[i] - 1];
          nums[nums[i] - 1] = nums[i];
          nums[i] = temp;
        }
      }
      for (int i = 0; i < iMax; i++) {
        if (nums[i] != i + 1) return i + 1;
      }
      return iMax + 1;
    }
  }
}
